// dragula@3.7.3 downloaded from https://ga.jspm.io/npm:dragula@3.7.3/dragula.js

import e from"contra/emitter";import t from"crossvent";var r={};var n={};var o="(?:^|\\s)";var i="(?:\\s|$)";function lookupClass(e){var t=n[e];t?t.lastIndex=0:n[e]=t=new RegExp(o+e+i,"g");return t}function addClass(e,t){var r=e.className;r.length?lookupClass(t).test(r)||(e.className+=" "+t):e.className=t}function rmClass(e,t){e.className=e.className.replace(lookupClass(t)," ").trim()}r={add:addClass,rm:rmClass};var a=r;var l="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var u={};var c=e;var v=t;var s=a;var d=document;var g=d.documentElement;function dragula(e,t){var r=arguments.length;if(1===r&&false===Array.isArray(e)){t=e;e=[]}var n;var o;var i;var a;var l;var u;var f;var m;var p;var h;var C;var y=null;var S;var b=t||{};void 0===b.moves&&(b.moves=always);void 0===b.accepts&&(b.accepts=always);void 0===b.invalid&&(b.invalid=invalidTarget);void 0===b.containers&&(b.containers=e||[]);void 0===b.isContainer&&(b.isContainer=never);void 0===b.copy&&(b.copy=false);void 0===b.copySortSource&&(b.copySortSource=false);void 0===b.revertOnSpill&&(b.revertOnSpill=false);void 0===b.removeOnSpill&&(b.removeOnSpill=false);void 0===b.direction&&(b.direction="vertical");void 0===b.ignoreInputTextSelection&&(b.ignoreInputTextSelection=true);void 0===b.mirrorContainer&&(b.mirrorContainer=d.body);var P=c({containers:b.containers,start:manualStart,end:end,cancel:cancel,remove:remove,destroy:destroy,canMove:canMove,dragging:false});true===b.removeOnSpill&&P.on("over",spillOver).on("out",spillOut);events();return P;function isContainer(e){return-1!==P.containers.indexOf(e)||b.isContainer(e)}function events(e){var t=e?"remove":"add";touchy(g,t,"mousedown",grab);touchy(g,t,"mouseup",release)}function eventualMovements(e){var t=e?"remove":"add";touchy(g,t,"mousemove",startBecauseMouseMoved)}function movements(e){var t=e?"remove":"add";v[t](g,"selectstart",preventGrabbed);v[t](g,"click",preventGrabbed)}function destroy(){events(true);release({})}function preventGrabbed(e){S&&e.preventDefault()}function grab(e){u=e.clientX;f=e.clientY;var t=1!==whichMouseButton(e)||e.metaKey||e.ctrlKey;if(!t){var r=e.target;var n=canStart(r);if(n){S=n;eventualMovements();"mousedown"===e.type&&(isInput(r)?r.focus():e.preventDefault())}}}function startBecauseMouseMoved(e){if(S)if(0!==whichMouseButton(e)){if(!(void 0!==e.clientX&&Math.abs(e.clientX-u)<=(b.slideFactorX||0)&&void 0!==e.clientY&&Math.abs(e.clientY-f)<=(b.slideFactorY||0))){if(b.ignoreInputTextSelection){var t=getCoord("clientX",e)||0;var r=getCoord("clientY",e)||0;var n=d.elementFromPoint(t,r);if(isInput(n))return}var o=S;eventualMovements(true);movements();end();start(o);var c=getOffset(i);a=getCoord("pageX",e)-c.left;l=getCoord("pageY",e)-c.top;s.add(h||i,"gu-transit");renderMirrorImage();drag(e)}}else release({})}function canStart(e){if((!P.dragging||!n)&&!isContainer(e)){var t=e;while(getParent(e)&&false===isContainer(getParent(e))){if(b.invalid(e,t))return;e=getParent(e);if(!e)return}var r=getParent(e);if(r&&!b.invalid(e,t)){var o=b.moves(e,r,t,nextEl(e));if(o)return{item:e,source:r}}}}function canMove(e){return!!canStart(e)}function manualStart(e){var t=canStart(e);t&&start(t)}function start(e){if(isCopy(e.item,e.source)){h=e.item.cloneNode(true);P.emit("cloned",h,e.item,"copy")}o=e.source;i=e.item;m=p=nextEl(e.item);P.dragging=true;P.emit("drag",i,o)}function invalidTarget(){return false}function end(){if(P.dragging){var e=h||i;drop(e,getParent(e))}}function ungrab(){S=false;eventualMovements(true);movements(true)}function release(e){ungrab();if(P.dragging){var t=h||i;var r=getCoord("clientX",e)||0;var a=getCoord("clientY",e)||0;var l=getElementBehindPoint(n,r,a);var u=findDropTarget(l,r,a);u&&(h&&b.copySortSource||!h||u!==o)?drop(t,u):b.removeOnSpill?remove():cancel()}}function drop(e,t){var r=getParent(e);h&&b.copySortSource&&t===o&&r.removeChild(i);isInitialPlacement(t)?P.emit("cancel",e,o,o):P.emit("drop",e,t,o,p);cleanup()}function remove(){if(P.dragging){var e=h||i;var t=getParent(e);t&&t.removeChild(e);P.emit(h?"cancel":"remove",e,t,o);cleanup()}}function cancel(e){if(P.dragging){var t=arguments.length>0?e:b.revertOnSpill;var r=h||i;var n=getParent(r);var a=isInitialPlacement(n);false===a&&t&&(h?n&&n.removeChild(h):o.insertBefore(r,m));a||t?P.emit("cancel",r,o,o):P.emit("drop",r,n,o,p);cleanup()}}function cleanup(){var e=h||i;ungrab();removeMirrorImage();e&&s.rm(e,"gu-transit");C&&clearTimeout(C);P.dragging=false;y&&P.emit("out",e,y,o);P.emit("dragend",e);o=i=h=m=p=C=y=null}function isInitialPlacement(e,t){var r;r=void 0!==t?t:n?p:nextEl(h||i);return e===o&&r===m}function findDropTarget(e,t,r){var n=e;while(n&&!accepted())n=getParent(n);return n;function accepted(){var a=isContainer(n);if(false===a)return false;var l=getImmediateChild(n,e);var u=getReference(n,l,t,r);var c=isInitialPlacement(n,u);return!!c||b.accepts(i,n,o,u)}}function drag(e){if(n){e.preventDefault();var t=getCoord("clientX",e)||0;var r=getCoord("clientY",e)||0;var u=t-a;var c=r-l;n.style.left=u+"px";n.style.top=c+"px";var v=h||i;var s=getElementBehindPoint(n,t,r);var d=findDropTarget(s,t,r);var g=null!==d&&d!==y;if(g||null===d){out();y=d;over()}var f=getParent(v);if(d!==o||!h||b.copySortSource){var C;var S=getImmediateChild(d,s);if(null!==S)C=getReference(d,S,t,r);else{if(true!==b.revertOnSpill||h){h&&f&&f.removeChild(v);return}C=m;d=o}if(null===C&&g||C!==v&&C!==nextEl(v)){p=C;d.insertBefore(v,C);P.emit("shadow",v,d,o)}}else f&&f.removeChild(v)}function moved(e){P.emit(e,v,y,o)}function over(){g&&moved("over")}function out(){y&&moved("out")}}function spillOver(e){s.rm(e,"gu-hide")}function spillOut(e){P.dragging&&s.add(e,"gu-hide")}function renderMirrorImage(){if(!n){var e=i.getBoundingClientRect();n=i.cloneNode(true);n.style.width=getRectWidth(e)+"px";n.style.height=getRectHeight(e)+"px";s.rm(n,"gu-transit");s.add(n,"gu-mirror");b.mirrorContainer.appendChild(n);touchy(g,"add","mousemove",drag);s.add(b.mirrorContainer,"gu-unselectable");P.emit("cloned",n,i,"mirror")}}function removeMirrorImage(){if(n){s.rm(b.mirrorContainer,"gu-unselectable");touchy(g,"remove","mousemove",drag);getParent(n).removeChild(n);n=null}}function getImmediateChild(e,t){var r=t;while(r!==e&&getParent(r)!==e)r=getParent(r);return r===g?null:r}function getReference(e,t,r,n){var o="horizontal"===b.direction;var i=t!==e?inside():outside();return i;function outside(){var t=e.children.length;var i;var a;var l;for(i=0;i<t;i++){a=e.children[i];l=a.getBoundingClientRect();if(o&&l.left+l.width/2>r)return a;if(!o&&l.top+l.height/2>n)return a}return null}function inside(){var e=t.getBoundingClientRect();return resolve(o?r>e.left+getRectWidth(e)/2:n>e.top+getRectHeight(e)/2)}function resolve(e){return e?nextEl(t):t}}function isCopy(e,t){return"boolean"===typeof b.copy?b.copy:b.copy(e,t)}}function touchy(e,t,r,n){var o={mouseup:"touchend",mousedown:"touchstart",mousemove:"touchmove"};var i={mouseup:"pointerup",mousedown:"pointerdown",mousemove:"pointermove"};var a={mouseup:"MSPointerUp",mousedown:"MSPointerDown",mousemove:"MSPointerMove"};if(l.navigator.pointerEnabled)v[t](e,i[r],n);else if(l.navigator.msPointerEnabled)v[t](e,a[r],n);else{v[t](e,o[r],n);v[t](e,r,n)}}function whichMouseButton(e){if(void 0!==e.touches)return e.touches.length;if(void 0!==e.which&&0!==e.which)return e.which;if(void 0!==e.buttons)return e.buttons;var t=e.button;return void 0!==t?1&t?1:2&t?3:4&t?2:0:void 0}function getOffset(e){var t=e.getBoundingClientRect();return{left:t.left+getScroll("scrollLeft","pageXOffset"),top:t.top+getScroll("scrollTop","pageYOffset")}}function getScroll(e,t){return"undefined"!==typeof l[t]?l[t]:g.clientHeight?g[e]:d.body[e]}function getElementBehindPoint(e,t,r){e=e||{};var n=e.className||"";var o;e.className+=" gu-hide";o=d.elementFromPoint(t,r);e.className=n;return o}function never(){return false}function always(){return true}function getRectWidth(e){return e.width||e.right-e.left}function getRectHeight(e){return e.height||e.bottom-e.top}function getParent(e){return e.parentNode===d?null:e.parentNode}function isInput(e){return"INPUT"===e.tagName||"TEXTAREA"===e.tagName||"SELECT"===e.tagName||isEditable(e)}function isEditable(e){return!!e&&("false"!==e.contentEditable&&("true"===e.contentEditable||isEditable(getParent(e))))}function nextEl(e){return e.nextElementSibling||manually();function manually(){var t=e;do{t=t.nextSibling}while(t&&1!==t.nodeType);return t}}function getEventHost(e){return e.targetTouches&&e.targetTouches.length?e.targetTouches[0]:e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e}function getCoord(e,t){var r=getEventHost(t);var n={pageX:"clientX",pageY:"clientY"};e in n&&!(e in r)&&n[e]in r&&(e=n[e]);return r[e]}u=dragula;var f=u;export default f;

